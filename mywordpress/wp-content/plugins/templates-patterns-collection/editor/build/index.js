!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=35)}([function(e,t){e.exports=window.wp.element},function(e,t){e.exports=window.wp.i18n},function(e,t){e.exports=window.wp.components},function(e,t){e.exports=window.regeneratorRuntime},function(e,t){e.exports=window.wp.data},function(e,t){function r(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(a,c){var o=e.apply(t,n);function i(e){r(o,a,c,i,s,"next",e)}function s(e){r(o,a,c,i,s,"throw",e)}i(void 0)}))}}},function(e,t,r){var n=r(27),a=r(28),c=r(29),o=r(31);e.exports=function(e,t){return n(e)||a(e,t)||c(e,t)||o()}},function(e,t){e.exports=window.wp.primitives},function(e,t,r){var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var c=typeof n;if("string"===c||"number"===c)e.push(n);else if(Array.isArray(n)&&n.length){var o=a.apply(null,n);o&&e.push(o)}else if("object"===c)for(var i in n)r.call(n,i)&&n[i]&&e.push(i)}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t,r){"use strict";const n=r(32),a=r(33),c=r(34);function o(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function s(e,t){return t.decode?a(e):e}function l(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function u(e){const t=(e=l(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function m(e,t){o((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const a="string"==typeof r&&r.includes(e.arrayFormatSeparator),c="string"==typeof r&&!a&&s(r,e).includes(e.arrayFormatSeparator);r=c?s(r,e):r;const o=a||c?r.split(e.arrayFormatSeparator).map(t=>s(t,e)):null===r?r:s(r,e);n[t]=o};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const a of e.split("&")){let[e,o]=c(t.decode?a.replace(/\+/g," "):a,"=");o=void 0===o?null:["comma","separator"].includes(t.arrayFormat)?o:s(o,t),r(s(e,t),o,n)}for(const e of Object.keys(n)){const r=n[e];if("object"==typeof r&&null!==r)for(const e of Object.keys(r))r[e]=p(r[e],t);else n[e]=p(r,t)}return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce((e,t)=>{const r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(r):e[t]=r,e},Object.create(null))}t.extract=u,t.parse=m,t.stringify=(e,t)=>{if(!e)return"";o((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const a=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[i(t,e),"[",a,"]"].join("")]:[...r,[i(t,e),"[",i(a,e),"]=",i(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[i(t,e),"[]"].join("")]:[...r,[i(t,e),"[]=",i(n,e)].join("")];case"comma":case"separator":return t=>(r,n)=>null==n||0===n.length?r:0===r.length?[[i(t,e),"=",i(n,e)].join("")]:[[r,i(n,e)].join(e.arrayFormatSeparator)];default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,i(t,e)]:[...r,[i(t,e),"=",i(n,e)].join("")]}}(t),a={};for(const t of Object.keys(e))r(t)||(a[t]=e[t]);const c=Object.keys(a);return!1!==t.sort&&c.sort(t.sort),c.map(r=>{const a=e[r];return void 0===a?"":null===a?i(r,t):Array.isArray(a)?a.reduce(n(r),[]).join("&"):i(r,t)+"="+i(a,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,n]=c(e,"#");return Object.assign({url:r.split("?")[0]||"",query:m(u(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:s(n,t)}:{})},t.stringifyUrl=(e,r)=>{r=Object.assign({encode:!0,strict:!0},r);const n=l(e.url).split("?")[0]||"",a=t.extract(e.url),c=t.parse(a,{sort:!1}),o=Object.assign(c,e.query);let s=t.stringify(o,r);s&&(s="?"+s);let u=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(e.url);return e.fragmentIdentifier&&(u="#"+i(e.fragmentIdentifier,r)),`${n}${s}${u}`}},function(e,t){e.exports=window.wp.apiFetch},function(e,t){e.exports=window.wp.blocks},function(e,t,r){var n=r(26);e.exports=function(e,t){if(null==e)return{};var r,a,c=n(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(c[r]=e[r])}return c}},function(e,t){e.exports=window.wp.compose},function(e,t){e.exports=window.wp.editPost},,,function(e,t){e.exports=window.wp.plugins},function(e,t){e.exports=window.wp.editSite},function(e,t){e.exports=window.wp.coreData},function(e,t){e.exports=window.wp.api},function(e,t){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=r=function(e){return typeof e}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(t)}e.exports=r},function(e,t){e.exports=window.wp.blockEditor},function(e,t){e.exports=window.wp.keycodes},function(e,t,r){},function(e,t){e.exports=function(e,t){if(null==e)return{};var r,n,a={},c=Object.keys(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}}},function(e,t,r){var n=r(30);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,r){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase())},function(e,t,r){"use strict";var n=new RegExp("%[a-f0-9]{2}","gi"),a=new RegExp("(%[a-f0-9]{2})+","gi");function c(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],c(r),c(n))}function o(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(n),r=1;r<t.length;r++)t=(e=c(t,r).join("")).match(n);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=a.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var n=o(r[0]);n!==r[0]&&(t[r[0]]=n)}r=a.exec(e)}t["%C2"]="�";for(var c=Object.keys(t),i=0;i<c.length;i++){var s=c[i];e=e.replace(new RegExp(s,"g"),t[s])}return e}(e)}}},function(e,t,r){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const r=e.indexOf(t);return-1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(18),c=r(12),o=(r(25),r(9)),i=r.n(o),s=r(4);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p={isFetching:!0,isPreview:!1,tab:3===parseInt(window.tiTpc.tier)?"library":"templates",templates:[],patterns:[],library:{items:[],currentPage:0,totalPages:0},preview:{type:"templates",item:{}}};Object(s.registerStore)("tpc/block-editor",{reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;return"SET_FETCHING"===t.type?u(u({},e),{},{isFetching:t.isFetching}):"TOGGLE_PREVIEW"===t.type?u(u({},e),{},{isPreview:!e.isPreview}):"UPDATE_CURRENT_TAB"===t.type?u(u({},e),{},{tab:t.tab,isPreview:!1}):"UPDATE_TEMPLATES"===t.type?u(u({},e),{},{templates:{items:t.items,currentPage:Number(t.currentPage),totalPages:Number(t.totalPages)}}):"UPDATE_PATTERNS"===t.type?u(u({},e),{},{patterns:t.items}):"UPDATE_LIBRARY"===t.type?u(u({},e),{},{library:{items:t.items,currentPage:Number(t.currentPage),totalPages:Number(t.totalPages)}}):"SET_PREVIEW_DATA"===t.type?u(u({},e),{},{preview:t.preview}):e},selectors:{isFetching:function(e){return e.isFetching},isPreview:function(e){return e.isPreview},getCurrentTab:function(e){return e.tab},getTemplates:function(e){return e.templates},getPatterns:function(e){return e.patterns},getLibrary:function(e){return e.library},getPreview:function(e){return e.preview}},actions:{setFetching:function(e){return{type:"SET_FETCHING",isFetching:e}},togglePreview:function(e){return{type:"TOGGLE_PREVIEW",isPreview:e}},updateCurrentTab:function(e){return{type:"UPDATE_CURRENT_TAB",tab:e}},updateTemplates:function(e,t,r){return{type:"UPDATE_TEMPLATES",items:e,currentPage:t,totalPages:r}},updatePatterns:function(e){return{type:"UPDATE_PATTERNS",items:e}},updateLibrary:function(e,t,r){return{type:"UPDATE_LIBRARY",items:e,currentPage:t,totalPages:r}},setPreviewData:function(e){return{type:"SET_PREVIEW_DATA",preview:e}}}});var m,b=r(0),d=r(8),f=r.n(d),O=wp.primitives,g=O.Path,h=O.SVG,j=function(e){var t=e.className;return Object(b.createElement)(h,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:f()(["tpc-icon",t])},Object(b.createElement)(g,{d:"M22.8063 24H1.19365C0.534714 24 0 23.4653 0 22.8063V1.19365C0 0.534714 0.534714 0 1.19365 0H22.8063C23.4653 0 24 0.534714 24 1.19365V22.8063C24 23.4653 23.4653 24 22.8063 24Z",fill:"#14171C"}),Object(b.createElement)(g,{d:"M19.8466 20.8187V7.39687V4.43164H16.884H3.45947L6.422 7.39687H16.884V17.8562L19.8466 20.8187Z",fill:"white"}),Object(b.createElement)(g,{d:"M10.138 14.1429L10.1407 17.0838L12.7764 19.7195L12.7656 11.5152L4.55859 11.5044L7.19435 14.1375L10.138 14.1429Z",fill:"white"}))},y=function(){return Object(b.createElement)(h,{width:"100",height:"100",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"tpc-template-cloud-icon"},Object(b.createElement)(g,{d:"M95.0264 100H4.97356C2.22797 100 0 97.772 0 95.0264V4.97356C0 2.22797 2.22797 0 4.97356 0H95.0264C97.772 0 100 2.22797 100 4.97356V95.0264C100 97.772 97.772 100 95.0264 100Z",fill:"#0366D6"}),Object(b.createElement)(g,{d:"M82.6941 86.7448V30.8205V18.4653H70.3502H14.4146L26.7584 30.8205H70.3502V74.401L82.6941 86.7448Z",fill:"white"}),Object(b.createElement)(g,{d:"M42.2416 58.9291L42.2528 71.183L53.2352 82.1653L53.1902 47.9806L18.9941 47.9355L29.9765 58.9066L42.2416 58.9291Z",fill:"white"}))},_=r(13),v=r.n(_),w=r(3),E=r.n(w),S=r(5),k=r.n(S),P=r(6),x=r.n(P),T=r(11),C=r.n(T),N=r(2),B=r(15),D=r(10),F=new Uint8Array(16);function L(){if(!m&&!(m="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m(F)}for(var I=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,M=function(e){return"string"==typeof e&&I.test(e)},U=[],A=0;A<256;++A)U.push((A+256).toString(16).substr(1));var R=function(e,t,r){var n=(e=e||{}).random||(e.rng||L)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=n[a];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(U[e[t+0]]+U[e[t+1]]+U[e[t+2]]+U[e[t+3]]+"-"+U[e[t+4]]+U[e[t+5]]+"-"+U[e[t+6]]+U[e[t+7]]+"-"+U[e[t+8]]+U[e[t+9]]+"-"+U[e[t+10]]+U[e[t+11]]+U[e[t+12]]+U[e[t+13]]+U[e[t+14]]+U[e[t+15]]).toLowerCase();if(!M(r))throw TypeError("Stringified UUID is invalid");return r}(n)};function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var H=Object(s.dispatch)("tpc/block-editor"),G=H.updateLibrary,q=H.updateTemplates,Q=Object(s.dispatch)("core/notices").createNotice,$=tiTpc.params,J=($.meta,v()($,["meta"])),W=function(e){Q("warning",e,{context:"themeisle-blocks/notices/templates-cloud",isDismissible:!0})},Z=function(){var e=k()(E.a.mark((function e(){var t,r,n,a,c,o,i,s=arguments;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=z(z({cache:localStorage.getItem("tpcCacheBuster")},J),{},{per_page:12,page:0,premade:!0,template_site_slug:"general"},t),"gutenberg"===tiTpc.params.type&&r.showFSE&&(r.type=["gutenberg","fse"]),n=Object(D.stringifyUrl)({url:tiTpc.endpoint+"page-templates",query:r},{arrayFormat:"bracket"}),e.prev=4,e.next=7,C()({url:n,method:"GET",parse:!1});case 7:if(!(a=e.sent).ok){e.next=17;break}return e.next=11,a.json();case 11:if(!(c=e.sent).message){e.next=14;break}return e.abrupt("return",W(c.message));case 14:o=a.headers.get("x-wp-totalpages"),i=r.page,q(c,i,o);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),e.t0.message&&W(e.t0.message);case 22:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=k()(E.a.mark((function e(){var t,r,n,a,c,o,i,s=arguments;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=z({per_page:12,page:0},t),"gutenberg"===tiTpc.params.type&&r.showFSE&&(r.type=["gutenberg","fse"]),n=Object(D.stringifyUrl)({url:tiTpc.endpoint+"templates",query:z(z({cache:localStorage.getItem("tpcCacheBuster")},J),r)},{arrayFormat:"bracket"}),e.prev=4,e.next=7,C()({url:n,method:"GET",parse:!1});case 7:if(!(a=e.sent).ok){e.next=17;break}return e.next=11,a.json();case 11:if(!(c=e.sent).message){e.next=14;break}return e.abrupt("return",W(c.message));case 14:o=a.headers.get("x-wp-totalpages"),i=r.page,G(c,i,o);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),e.t0.message&&W(e.t0.message);case 22:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=k()(E.a.mark((function e(t){var r,n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(D.stringifyUrl)({url:"".concat(tiTpc.endpoint,"templates/").concat(t.template_id),query:z(z({cache:localStorage.getItem("tpcCacheBuster")},J),{},{meta:JSON.stringify(tiTpc.params.meta)},t)}),e.prev=1,e.next=4,C()({url:r,method:"POST",parse:!1});case 4:if(!(n=e.sent).ok){e.next=11;break}return e.next=8,n.json();case 8:if(!(a=e.sent).message){e.next=11;break}return e.abrupt("return",W(a.message));case 11:return localStorage.setItem("tpcCacheBuster",R()),e.next=14,Z();case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),e.t0.message&&W(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=k()(E.a.mark((function e(t){var r,n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(D.stringifyUrl)({url:"".concat(window.tiTpc.endpoint,"templates/").concat(t),query:z({cache:localStorage.getItem("tpcCacheBuster")},J)}),e.prev=1,e.next=4,C()({url:r,method:"GET",parse:!1});case 4:if(!(n=e.sent).ok){e.next=12;break}return e.next=8,n.json();case 8:if(!(a=e.sent).message){e.next=11;break}return e.abrupt("return",!1);case 11:return e.abrupt("return",a);case 12:e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(1),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=k()(E.a.mark((function e(t){var r,n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(D.stringifyUrl)({url:"".concat(tiTpc.endpoint,"templates/").concat(t,"/import"),query:z({cache:localStorage.getItem("tpcCacheBuster")},J)}),n={},e.prev=2,e.next=5,C()({url:r,method:"GET",parse:!1});case 5:if(!(a=e.sent).ok){e.next=12;break}return e.next=9,a.json();case 9:if(!(n=e.sent).message){e.next=12;break}return e.abrupt("return",W(n.message));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),e.t0.message&&W(e.t0.message);case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=k()(E.a.mark((function e(t,r){var n,a,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(D.stringifyUrl)({url:"".concat(tiTpc.endpoint,"templates/").concat(t),query:z({cache:localStorage.getItem("tpcCacheBuster"),_method:"DELETE"},J)}),e.prev=1,e.next=4,C()({url:n,method:"POST"});case 4:if(!(a=e.sent).ok){e.next=11;break}return e.next=8,a.json();case 8:if(!(c=e.sent).message){e.next=11;break}return e.abrupt("return",W(c.message));case 11:return localStorage.setItem("tpcCacheBuster",R()),e.next=14,Y(r);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),e.t0.message&&W(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t,r){return e.apply(this,arguments)}}(),re=function(){var e=k()(E.a.mark((function e(t,r,n,a,c){var o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(D.stringifyUrl)({url:"".concat(tiTpc.endpoint,"templates/").concat(t,"/publish"),query:z({cache:localStorage.getItem("tpcCacheBuster"),method:"POST",template_site_slug:r,template_thumbnail:n,premade:a?"yes":"no",link:c},J)}),e.prev=1,e.next=4,C()({url:o,method:"POST",headers:{Authorization:"Bearer  ".concat(tiTpc.bearer||""," ")}});case 4:if(!(i=e.sent).ok){e.next=14;break}return e.next=8,i.json();case 8:if(!(s=e.sent).message){e.next=12;break}return W(s.message),e.abrupt("return",{success:!1});case 12:e.next=17;break;case 14:if(!i.message){e.next=17;break}return W(i.message),e.abrupt("return",{success:!1});case 17:return localStorage.setItem("tpcCacheBuster",R()),e.abrupt("return",{success:!0});case 21:if(e.prev=21,e.t0=e.catch(1),!e.t0.message){e.next=26;break}return W(e.t0.message),e.abrupt("return",{success:!1});case 26:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(t,r,n,a,c){return e.apply(this,arguments)}}();function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ce=function(e){var t=e.canPredefine,r=e.setLoading,a=e.templateData,c=e.setScreenshotURL,o=e.setPublished,i=e.saveMeta,s=e.createSuccessNotice,l=e.published,u=e.createErrorNotice,p=e.isLoading;if(!t)return null;var m=a._ti_tpc_template_id,d=a._ti_tpc_site_slug,O=a._ti_tpc_screenshot_url,g=a._ti_tpc_published,h=a.link,j=function(){var e=k()(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r("publishing"),e.prev=1,e.next=4,re(m,d,O,!g,h).then(function(){var e=k()(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.success){e.next=3;break}return e.next=3,X(m).then((function(e){m===e.template_id&&(c(e.template_thumbnail),o(!l),i(ae(ae({},a),{},{_ti_tpc_published:!l})),s(l?Object(n.__)("Template Unpublished.","templates-patterns-collection"):Object(n.__)("Template Published.","templates-patterns-collection"),{type:"snackbar"}))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),u(Object(n.__)("Something happened when publishing the template.","templates-patterns-collection"));case 9:r(!1);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}();return Object(b.createElement)(N.Button,{isSecondary:!0,onClick:j,disabled:!1!==p,className:f()({"is-loading":"publishing"===p})},l&&("publishing"===p?Object(n.__)("Unpublishing","templates-patterns-collection"):Object(n.__)("Unpublish","templates-patterns-collection")),!l&&("publishing"===p?Object(n.__)("Publishing","templates-patterns-collection"):Object(n.__)("Publish","templates-patterns-collection")))},oe=function(){var e=Object(s.useSelect)((function(e){return e("core/notices").getNotices("themeisle-blocks/notices/templates-cloud")})),t=Object(s.useDispatch)("core/notices").removeNotice;return Object(b.createElement)("div",{className:"notices"},e.map((function(e){return Object(b.createElement)(N.Notice,{key:e.id,status:e.status,isDismissible:e.isDismissible,onRemove:function(){return t(e.id,"themeisle-blocks/notices/templates-cloud")},actions:e.actions},e.content)})))};function ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var le=r(19),ue=r(20),pe=r(21),me=r.n(pe);function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var fe=function(e){var t=e.templateData,r=e.setTemplateData,a=e.canPredefine,c=e.setLoading,o=e.createErrorNotice,i=e.createSuccessNotice,s=e.isLoading,l=e.saveMeta,u=function(e){r(de(de({},t),{},{_ti_tpc_screenshot_url:e}))},p=function(){var e=k()(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("publishing"),e.prev=1,e.next=4,X(t._ti_tpc_template_id).then((function(e){t._ti_tpc_template_id===e.template_id&&(e.template_thumbnail&&(u(e.template_thumbnail),l(de(de({},t),{},{_ti_tpc_screenshot_url:e.template_thumbnail}))),i(Object(n.__)("Template Data Refreshed.","templates-patterns-collection"),{type:"snackbar"}))}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),o(Object(n.__)("Something happened when refreshing the template data.","templates-patterns-collection"));case 9:c(!1);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}();return Object(b.createElement)(N.PanelBody,null,Object(b.createElement)("h4",null,Object(n.__)("Publish Settings","templates-patterns-collection")),Object(b.createElement)(N.TextControl,{label:Object(n.__)("Screenshot URL","templates-patterns-collection"),value:t._ti_tpc_screenshot_url||"",help:Object(n.__)("Use `{generate_ss}` to publish this and have a screenshot automatically generated. Otherwise use the url to point to an image location for the template preview.","templates-patterns-collection"),type:"url",onChange:u}),Object(b.createElement)(N.TextControl,{label:Object(n.__)("Site Slug","templates-patterns-collection"),value:t._ti_tpc_site_slug,help:Object(n.__)("Use `general` to publish this as a global template. Otherwise use the starter site slug to make it available as a single page for the starter site.","templates-patterns-collection"),type:"url",onChange:function(e){return r(de(de({},t),{},{_ti_tpc_site_slug:e}))}}),Object(b.createElement)(N.TextControl,{label:Object(n.__)("Previewer URL","templates-patterns-collection"),value:t._ti_tpc_previewer_url||"",help:Object(n.__)("Provide a URL to a previewer for this template. This will be used to display a preview of the template in the editor.","templates-patterns-collection"),type:"url",onChange:function(e){return r(de(de({},t),{},{_ti_tpc_previewer_url:e}))}}),Object(b.createElement)(ce,{canPredefine:a,setLoading:c,templateData:de(de({},t),{},{link:t._ti_tpc_previewer_url}),setScreenshotURL:u,setPublished:function(e){r(de(de({},t),{},{_ti_tpc_published:e}))},saveMeta:l,published:t._ti_tpc_published||!1,createErrorNotice:o,createSuccessNotice:i,isLoading:s}),t._ti_tpc_published&&Object(b.createElement)(N.Button,{isLink:!0,icon:"image-rotate",onClick:p,disabled:!1!==s,className:f()({"is-loading":"publishing"===s}),style:{marginLeft:"12px",textDecoration:"none"}},Object(n.__)("Refresh","templates-patterns-collection")),Object(b.createElement)(oe,null))},Oe=r(22),ge=r.n(Oe),he=r(7),je=Object(b.createElement)(he.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(b.createElement)(he.Path,{d:"M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"})),ye=Object(b.createElement)(he.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},Object(b.createElement)(he.Path,{d:"M10.2 3.28c3.53 0 6.43 2.61 6.92 6h2.08l-3.5 4-3.5-4h2.32c-.45-1.97-2.21-3.45-4.32-3.45-1.45 0-2.73.71-3.54 1.78L4.95 5.66C6.23 4.2 8.11 3.28 10.2 3.28zm-.4 13.44c-3.52 0-6.43-2.61-6.92-6H.8l3.5-4c1.17 1.33 2.33 2.67 3.5 4H5.48c.45 1.97 2.21 3.45 4.32 3.45 1.45 0 2.73-.71 3.54-1.78l1.71 1.95c-1.28 1.46-3.15 2.38-5.25 2.38z"})),_e=Object(b.createElement)(he.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(b.createElement)(he.Path,{d:"M13 11.9l3.3-3.4-1.1-1-3.2 3.3-3.2-3.3-1.1 1 3.3 3.4-3.5 3.6 1 1L12 13l3.5 3.5 1-1z"}));function ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function we(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ee=function(e){var t=e.closeModal,r=e.getOrder,a=e.getSearchQuery,c=Object(s.useDispatch)("tpc/block-editor"),o=c.setFetching,i=c.updateCurrentTab,l={templates:Object(n.__)("Page Templates")};3===parseInt(tiTpc.tier)&&(l.library=Object(n.__)("My Library"));var u=Object(s.useSelect)((function(e){return e("tpc/block-editor").isFetching()})),p=Object(s.useSelect)((function(e){return e("tpc/block-editor").isPreview()})),m=Object(s.useSelect)((function(e){return e("tpc/block-editor").getCurrentTab()})),d=function(){var e=k()(E.a.mark((function e(){var t,n,c,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.localStorage.setItem("tpcCacheBuster",R()),o(!0),s=r(),e.next=5,Z(we(we({search:a()},s),{},{showFSE:!!tiTpc.isFSETheme&&"true"===(null===(t=window)||void 0===t||null===(n=t.localStorage)||void 0===n?void 0:n.tpcShowFse)}));case 5:return e.next=7,Y(we(we({search:a()},s),{},{showFSE:!!tiTpc.isFSETheme&&"true"===(null===(c=window)||void 0===c||null===(i=c.localStorage)||void 0===i?void 0:i.tpcShowFse)}));case 7:o(!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.createElement)("div",{className:"modal-header"},Object(b.createElement)("div",{className:"left"},Object(b.createElement)(N.Icon,{icon:y})),Object(b.createElement)("div",{className:"center"},Object.keys(l).map((function(e){return Object(b.createElement)(N.Button,{key:e,onClick:function(){return i(e)},className:f()("tabs",{"is-active":e===m})},l[e])}))),Object(b.createElement)("div",{className:"right"},"library"===m&&!p&&Object(b.createElement)(N.ButtonGroup,null,Object(b.createElement)(N.Button,{label:Object(n.__)("Re-sync Library"),icon:ye,disabled:u,className:f()("is-sync",{"is-loading":u}),onClick:d})),Object(b.createElement)(N.Button,{label:Object(n.__)("Close Modal"),icon:_e,onClick:t})))},Se=r(14),ke=r(23),Pe=function(e){var t=e.isFetching,r=e.importBlocks,a=Object(Se.useViewportMatch)("large",">="),o=Object(Se.useViewportMatch)("large","<="),i=Object(Se.useViewportMatch)("small",">="),l=Object(Se.useViewportMatch)("small","<="),u=1400;a||o||!i||l?!(a||o||i||l)&&(u=600):u=960;var p=Object(s.useDispatch)("tpc/block-editor"),m=p.setFetching,d=p.togglePreview,f=Object(s.useSelect)((function(e){return e("tpc/block-editor").getPreview()})).item;Object(b.useEffect)((function(){y()}),[]);var O=Object(b.useState)(""),g=x()(O,2),h=g[0],j=g[1],y=function(){var e=k()(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,_();case 3:m(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=k()(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,ee(f.template_id);case 3:(t=e.sent).__file&&t.content&&"wp_export"===t.__file&&j(t.content),m(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.createElement)("div",{className:"tpc-modal-content"},Object(b.createElement)("div",{className:"preview-header"},Object(b.createElement)("div",{className:"left"},f.template_name||Object(n.__)("Template")),Object(b.createElement)("div",{className:"right"},Object(b.createElement)(N.Button,{isSecondary:!0,onClick:d},Object(n.__)("Close Preview")),Object(b.createElement)(N.Button,{isPrimary:!0,isBusy:t,disabled:t,onClick:function(){d(),r(h,f.meta||[])}},Object(n.__)("Import")))),t?Object(b.createElement)(N.Placeholder,null,Object(b.createElement)(N.Spinner,null)):Object(b.createElement)("div",{className:"preview-content"},Object(b.createElement)(ke.BlockPreview,{blocks:Object(c.parse)(h),viewportWidth:u})))},xe=Object(b.createElement)(he.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(b.createElement)(he.Path,{d:"M13.5 6C10.5 6 8 8.5 8 11.5c0 1.1.3 2.1.9 3l-3.4 3 1 1.1 3.4-2.9c1 .9 2.2 1.4 3.6 1.4 3 0 5.5-2.5 5.5-5.5C19 8.5 16.5 6 13.5 6zm0 9.5c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z"})),Te=Object(b.createElement)(he.SVG,{xmlns:"https://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(b.createElement)(he.Path,{d:"M3 15h18v-2H3v2zm0 4h18v-2H3v2zm0-8h18V9H3v2zm0-6v2h18V5H3z"})),Ce=Object(b.createElement)(he.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(b.createElement)(he.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7.8 16.5H5c-.3 0-.5-.2-.5-.5v-6.2h6.8v6.7zm0-8.3H4.5V5c0-.3.2-.5.5-.5h6.2v6.7zm8.3 7.8c0 .3-.2.5-.5.5h-6.2v-6.8h6.8V19zm0-7.8h-6.8V4.5H19c.3 0 .5.2.5.5v6.2z",fillRule:"evenodd",clipRule:"evenodd"})),Ne=r(24);function Be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function De(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Fe={date:Object(n.__)("Date"),template_name:Object(n.__)("Name"),modified:Object(n.__)("Last Modified")},Le=function(e){var t=e.showFSE,r=e.onFSEChange,a=e.layout,c=e.sortingOrder,o=e.setLayout,i=e.isSearch,s=e.searchQuery,l=e.onSearch,u=e.setSearchQuery,p=e.setSortingOrder,m=e.changeOrder;return Object(b.createElement)("div",{className:"filters"},Object(b.createElement)("div",{className:"display-sorting"},Object(b.createElement)("div",{className:"sorting-label"},Object(n.__)("Sort by")),Object(b.createElement)("div",{className:"sorting-filter"},Object.keys(Fe).map((function(e){return Object(b.createElement)(N.Button,{key:e,className:f()({"is-selected":e===c.orderby,"is-asc":"ASC"===c.order}),onClick:function(){var t={order:"DESC",orderby:e};e===c.orderby&&"DESC"===c.order&&(t.order="ASC"),p(De({},t)),m(De({},t))}},Fe[e])}))),"gutenberg"===tiTpc.params.type&&tiTpc.isFSETheme&&Object(b.createElement)("div",{className:"filter-fse"},Object(b.createElement)(N.ToggleControl,{label:Object(n.__)("Show FSE Templates"),onChange:r,checked:t}))),Object(b.createElement)("div",{className:"view-filters"},Object(b.createElement)("div",{className:"search-filters"},Object(b.createElement)("input",{placeholder:Object(n.__)("Search for a template…"),className:"filter-search",value:s,onChange:function(e){return u(e.target.value)},onKeyDown:function(e){e.keyCode===Ne.ENTER&&l()}}),i?Object(b.createElement)(N.Button,{label:Object(n.__)("Clear search query"),icon:_e,onClick:function(){u(""),l("")}}):Object(b.createElement)(N.Button,{label:Object(n.__)("Search"),icon:xe,onClick:function(){return l()}})),Object(b.createElement)(N.Button,{label:Object(n.__)("List View"),icon:Te,onClick:function(){return o("list")},isPressed:"list"===a}),Object(b.createElement)(N.Button,{label:Object(n.__)("Grid View"),icon:Ce,onClick:function(){return o("grid")},isPressed:"grid"===a})))},Ie=Object(b.createElement)(he.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(b.createElement)(he.Path,{d:"M20.1 5.1L16.9 2 6.2 12.7l-1.3 4.4 4.5-1.3L20.1 5.1zM4 20.8h8v-1.5H4v1.5z"})),Me=Object(b.createElement)(he.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(b.createElement)(he.Path,{d:"M18.3 5.6L9.9 16.9l-4.6-3.4-.9 1.2 5.8 4.3 9.3-12.6z"})),Ue=Object(b.createElement)(he.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},Object(b.createElement)(he.Path,{d:"M12 4h3c.6 0 1 .4 1 1v1H3V5c0-.6.5-1 1-1h3c.2-1.1 1.3-2 2.5-2s2.3.9 2.5 2zM8 4h3c-.2-.6-.9-1-1.5-1S8.2 3.4 8 4zM4 7h11l-.9 10.1c0 .5-.5.9-1 .9H5.9c-.5 0-.9-.4-1-.9L4 7z"})),Ae=Object(b.createElement)(he.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(b.createElement)(he.Path,{d:"M7 5.5h10a.5.5 0 01.5.5v12a.5.5 0 01-.5.5H7a.5.5 0 01-.5-.5V6a.5.5 0 01.5-.5zM17 4H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V6a2 2 0 00-2-2zm-1 3.75H8v1.5h8v-1.5zM8 11h8v1.5H8V11zm6 3.25H8v1.5h6v-1.5z"})),Re=function(e){var t=e.sortingOrder,r=e.layout,a=e.item,c=e.importBlocks,o=e.deletable,i=Object(s.useDispatch)("tpc/block-editor"),l=i.togglePreview,u=i.setPreviewData,p=Object(b.useState)(!1),m=x()(p,2),d=m[0],O=m[1],g=Object(b.useState)(!1),h=x()(g,2),j=h[0],y=h[1],_=Object(b.useState)(a.template_name),v=x()(_,2),w=v[0],S=v[1],P=function(){var e=k()(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O("importing"),e.next=3,ee(a.template_id);case 3:(t=e.sent).__file&&t.content&&"wp_export"===t.__file&&c(t.content,a.meta||[],a.template_type),O(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=k()(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O("updating"),e.next=3,K({template_id:a.template_id,template_name:w||a.template_name},t);case 3:return e.next=5,Y(t);case 5:O(!1),y(!j);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=k()(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm(Object(n.__)("Are you sure you want to delete this template?"))){e.next=2;break}return e.abrupt("return",!1);case 2:return O("deleting"),e.next=5,te(a.template_id,t);case 5:O(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=k()(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l(),u({type:"library",item:a});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if("grid"===r){var D={backgroundImage:"url(".concat(a.template_thumbnail,")")};return Object(b.createElement)("div",{key:a.template_id,className:"table-grid"},Object(b.createElement)("div",{style:D,className:f()("grid-preview",{"is-loading":j||!1!==d})},Object(b.createElement)("div",{className:"preview-actions"},Object(b.createElement)(N.Button,{isSecondary:!0,disabled:!1!==d,onClick:B},Object(n.__)("Preview")),Object(b.createElement)(N.Button,{isPrimary:!0,isBusy:"importing"===d,disabled:!1!==d,onClick:P},Object(n.__)("Import")),o&&Object(b.createElement)("div",{className:"preview-controls"},!a.link&&Object(b.createElement)(N.Button,{label:Object(n.__)("Edit"),icon:"updating"===d?ye:Ie,disabled:j||!1!==d,className:f()({"is-loading":"updating"===d}),onClick:function(){return y(!j)}},j&&Object(b.createElement)(N.Popover,{onFocusOutside:function(){return y(!j)},className:"controls-popover",inline:!0},Object(b.createElement)("div",{className:"popover-content"},Object(b.createElement)(N.TextControl,{label:Object(n.__)("Template Name"),value:w,onChange:S}),Object(b.createElement)(N.Button,{label:Object(n.__)("Update"),icon:"updating"===d?ye:Me,disabled:!1!==d,className:f()({"is-loading":"updating"===d}),onClick:T})))),Object(b.createElement)(N.Button,{label:Object(n.__)("Delete"),icon:"deleting"===d?ye:Ue,disabled:!1!==d,className:f()({"is-loading":"deleting"===d}),onClick:C})))),Object(b.createElement)("div",{className:"card-footer"},Object(b.createElement)("p",null,a.template_name),"fse"===a.template_type&&Object(b.createElement)("div",{className:"type-label"},"FSE")))}var F=f()("actions",{"no-controls":!o});return Object(b.createElement)("div",{key:a.template_id,className:"table-row"},Object(b.createElement)("div",{className:"row-title"},Object(b.createElement)(N.Icon,{icon:Ae}),j?Object(b.createElement)(N.TextControl,{label:Object(n.__)("Template Name"),hideLabelFromVision:!0,value:w,onChange:S}):a.template_name),"fse"===a.template_type&&Object(b.createElement)("div",{className:"row-type"},Object(b.createElement)("div",{className:"type-label"},"FSE")),o&&Object(b.createElement)("div",{className:"row-controls"},a.link?Object(b.createElement)(N.Tooltip,{text:Object(n.__)("This template is synced to a page.")},Object(b.createElement)(N.Button,{label:Object(n.__)("Edit"),icon:Ie,disabled:!0},Object(n.__)("Edit"))):Object(b.createElement)(N.Button,{label:j?Object(n.__)("Update"):Object(n.__)("Edit"),icon:j?"updating"===d?ye:Me:Ie,disabled:!1!==d,className:f()({"is-loading":"updating"===d}),onClick:j?T:function(){return y(!j)}},j?Object(n.__)("Update"):Object(n.__)("Edit")),Object(b.createElement)(N.Button,{label:Object(n.__)("Delete"),icon:"deleting"===d?ye:Ue,disabled:!1!==d,className:f()({"is-loading":"deleting"===d}),onClick:C},"deleting"===d?Object(n.__)("Deleting")+"...":Object(n.__)("Delete"))),Object(b.createElement)("div",{className:F},Object(b.createElement)(N.Button,{isSecondary:!0,disabled:!1!==d,onClick:B},Object(n.__)("Preview")),Object(b.createElement)(N.Button,{isPrimary:!0,isBusy:"importing"===d,disabled:!1!==d,onClick:P},Object(n.__)("Import"))))},Ve=function(e){var t=e.total,r=e.current,n=e.onChange;if(t<2)return null;for(var a=[],c=function(e){var t=e===r;a.push(Object(b.createElement)(N.Button,{key:"page-".concat(e),isPrimary:t,disabled:t,onClick:function(){return n(e)}},e+1))},o=0;o<t;o++)c(o);return Object(b.createElement)(N.ButtonGroup,{className:"pagination"},a)};function ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ge=Object(s.withSelect)((function(e,t){var r=t.isGeneral?e("tpc/block-editor").getTemplates():e("tpc/block-editor").getLibrary(),n=r.items;return{items:void 0===n?[]:n,currentPage:r.currentPage,totalPages:r.totalPages}}))((function(e){var t,r,a=e.importBlocks,c=e.isGeneral,o=void 0!==c&&c,i=e.isFetching,l=e.items,u=e.currentPage,p=e.totalPages,m=e.getOrder,d=e.setQuery,O=e.getSearchQuery,g=e.setSorting,h=Object(s.useDispatch)("tpc/block-editor").setFetching,j=Object(b.useState)("grid"),y=x()(j,2),_=y[0],v=y[1],w=Object(b.useState)(!!tiTpc.isFSETheme&&"true"===(null===(t=window)||void 0===t||null===(r=t.localStorage)||void 0===r?void 0:r.tpcShowFse)),S=x()(w,2),P=S[0],T=S[1],C=Object(b.useState)({templates:!1,library:!1}),B=x()(C,2),D=B[0],F=B[1],L=function(e){return F(He(He({},D),{},o?{templates:e}:{library:e}))},I=function(){return o?D.templates:D.library},M=function(){var e=k()(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h(!0),t=m(),!o){e.next=7;break}return e.next=5,Z(He({search:O(),showFSE:P},t));case 5:e.next=9;break;case 7:return e.next=9,Y(He({search:O(),showFSE:P},t));case 9:h(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(b.useEffect)((function(){l&&l.length>0||M()}),[o]);var U=function(){var e=k()(E.a.mark((function e(t){var r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h(!0),r=m(),!o){e.next=7;break}return e.next=5,Z(He({search:O(),page:t},r));case 5:e.next=9;break;case 7:return e.next=9,Y(He({search:O(),page:t},r));case 9:h(!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=k()(E.a.mark((function e(){var t,r,n=arguments;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:O(),h(!0),L(!!t),r=m(),!o){e.next=9;break}return e.next=7,Z(He({search:t},r));case 7:e.next=11;break;case 9:return e.next=11,Y(He({search:t},r));case 11:h(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=k()(E.a.mark((function e(){var t,r,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h(!0),T(t=!P),window.localStorage.setItem("tpcShowFse",t.toString()),r=m(),n=O(),!o){e.next=11;break}return e.next=9,Z(He(He({search:n},r),{},{showFSE:t}));case 9:e.next=13;break;case 11:return e.next=13,Y(He(He({search:n},r),{},{showFSE:t}));case 13:h(!1);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=k()(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h(!0),!o){e.next=6;break}return e.next=4,Z(He(He({},t),{},{search:O()}));case 4:e.next=8;break;case 6:return e.next=8,Y(He(He({},t),{},{search:O()}));case 8:h(!1);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(i)return Object(b.createElement)(b.Fragment,null,Object(b.createElement)(Le,{showFSE:P,onFSEChange:R,layout:_,sortingOrder:m(),setLayout:v,isSearch:I(),searchQuery:O(),onSearch:A,setSearchQuery:d,setSortingOrder:g,changeOrder:V}),Object(b.createElement)(N.Placeholder,null,Object(b.createElement)(N.Spinner,null)));if(!Boolean(l.length))return Object(b.createElement)("div",{className:"table-content"},Object(b.createElement)(Le,{showFSE:P,onFSEChange:R,layout:_,sortingOrder:m(),setLayout:v,isSearch:I(),searchQuery:O(),onSearch:A,setSearchQuery:d,setSortingOrder:g,changeOrder:V}),Object(n.__)("No templates available. Add a new one?"));var z=f()("table-content",{"is-grid":"grid"===_});return Object(b.createElement)(b.Fragment,null,Object(b.createElement)(Le,{showFSE:P,onFSEChange:R,layout:_,sortingOrder:m(),setLayout:v,isSearch:I(),searchQuery:O(),onSearch:A,setSearchQuery:d,setSortingOrder:g,changeOrder:V}),Object(b.createElement)("div",{className:z},l.map((function(e){return Object(b.createElement)(Re,{sortingOrder:m(),deletable:!o,key:e.template_id,layout:_,item:e,importBlocks:a})}))),Object(b.createElement)(Ve,{onChange:U,current:u,total:p}))})),qe=Object(s.withSelect)((function(e){var t=e("tpc/block-editor"),r=t.isPreview,n=t.isFetching,a=t.getCurrentTab;return{isPreview:r(),isFetching:n(),currentTab:a()}}))((function(e){var t=e.importBlocks,r=e.getOrder,a=e.setQuery,c=e.getSearchQuery,o=e.setSorting,i=e.isPreview,s=e.currentTab,l=e.isFetching;return i&&"library"===s?Object(b.createElement)(Pe,{isFetching:l,importBlocks:t}):Object(b.createElement)("div",{className:"tpc-modal-content"},Object(b.createElement)(oe,null),["templates","library"].includes(s)&&Object(b.createElement)(Ge,{isFetching:l,isGeneral:"templates"===s,importBlocks:t,getOrder:r,setQuery:a,getSearchQuery:c,setSorting:o}),"patterns"===s&&Object(n.__)("We are still working on this. Please check back later. Thank you!"))})),Qe=function(e){var t=e.title,r=e.leftButtons,a=e.rightButtons,c=e.heading,o=e.previewUrl,i=Object(D.stringifyUrl)({url:o,query:{tpcpreview:"yes"}}),s=t||Object(n.__)("Preview");return Object(b.createElement)("div",{className:"ob-preview single-templates"},Object(b.createElement)("div",{className:"preview"},Object(b.createElement)("iframe",{title:s,src:i,frameBorder:"0"}),Object(b.createElement)("div",{className:"loading"},Object(b.createElement)(N.Dashicon,{icon:"update",size:50}))),Object(b.createElement)("div",{className:"bottom-bar"},r&&Object(b.createElement)("div",{className:"navigator"},r),c&&Object(b.createElement)("h2",{className:"heading"},c),a&&Object(b.createElement)("div",{className:"actions"},a)))};function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var We=function(e){var t=e.clientId,r=e.autoLoad,a=void 0===r||r,o=e.isFse,i=void 0!==o&&o,l=e.modalOpen,u=e.setModalOpen,p=Object(s.useSelect)((function(e){return{isPreview:e("tpc/block-editor").isPreview(),currentTab:e("tpc/block-editor").getCurrentTab(),previewData:e("tpc/block-editor").getPreview()}})),m=p.isPreview,d=p.currentTab,f=p.previewData,O=Object(s.useDispatch)("core/block-editor"),g=O.removeBlock,h=O.replaceBlocks,j=O.insertBlocks,y=O.resetBlocks,_=Object(s.useDispatch)("tpc/block-editor").togglePreview,w=function(){return _(!1)},S=Object(s.useSelect)((function(e){return{type:e("core/editor").getEditedPostAttribute("type")}})).type,P=Object(s.useDispatch)("core/notices").createErrorNotice,T=Object(s.useDispatch)("core/editor").editPost,C=Object(s.useDispatch)("tpc/block-editor"),B=C.updateLibrary,D=C.updateTemplates,F=Object(b.useState)(!1),L=x()(F,2),I=L[0],M=L[1],U=Object(b.useState)({templates:"",library:""}),A=x()(U,2),R=A[0],V=A[1],z=Object(b.useState)({templates:{order:"DESC",orderby:"date"},library:{order:"DESC",orderby:"date"}}),H=x()(z,2),G=H[0],q=H[1],Q="templates"===d,$=function(){return Q?R.templates:R.library},J=function(){return Q?G.templates:G.library},W=function(e){try{var t=JSON.parse(e);if(t&&"object"===ge()(t))return t}catch(e){}return!1},Z=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";B([]),D([]);var a=window.tiTpc.allowed_post;if(0<Object.keys(W(r)||{}).length&&a.includes(S)){var o=JSON.parse(r),i=(o._wp_page_template,v()(o,["_wp_page_template"])),s=Je({},i);T({meta:s}),"page"===S&&o._wp_page_template&&T({template:o._wp_page_template})}t?h(t,Object(c.parse)(e)):"fse"===n?y(Object(c.parse)(e)):j(Object(c.parse)(e)),K()},Y=function(){var e=k()(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(!0),e.next=3,ee(f.template_id).then((function(e){if(e.__file&&e.content&&"wp_export"===e.__file)return w(),M(!1),Z(e.content,f.meta||[],f.template_type),!1;P(Object(n.__)("Something went wrong while importing. Please try again."),{type:"snackbar"}),M(!1),g(t)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){u(!1),M(!1),i||g(t)};return Object(b.useEffect)((function(){a&&setTimeout((function(){u(!0)}),100)}),[]),l?Object(b.createElement)(b.Fragment,null,Object(b.createElement)(N.Modal,{onRequestClose:K,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!m||"templates"!==d,isDismissible:!1,overlayClassName:"tpc-template-cloud-modal"},Object(b.createElement)(Ee,{closeModal:K,getOrder:J,getSearchQuery:$}),Object(b.createElement)(qe,{importBlocks:Z,getOrder:J,setQuery:function(e){return V(Je(Je({},R),{},Q?{templates:e}:{library:e}))},getSearchQuery:$,setSorting:function(e){return q(Je(Je({},G),{},Q?{templates:e}:{library:e}))}}),Object(b.createElement)((function(){if(!m||"templates"!==d)return null;var e=f.link,t=f.template_name;return Object(b.createElement)(N.Modal,{isDismissible:!1,shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1,className:"tpc-preview-wrap-modal"},Object(b.createElement)(Qe,{previewUrl:e,heading:t,leftButtons:Object(b.createElement)(b.Fragment,null,Object(b.createElement)(N.Button,{disabled:I,icon:je,onClick:w})),rightButtons:Object(b.createElement)(N.Button,{disabled:I,isPrimary:!0,onClick:Y},I?Object(n.__)("Importing")+"...":Object(n.__)("Import"))}),";")}),null))):null};function Ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ke=function(){var e=Object(b.useState)(!1),t=x()(e,2),r=t[0],a=t[1];return Object(b.createElement)(b.Fragment,null,Object(b.createElement)(N.Button,{icon:j,isPrimary:!0,onClick:function(){return a(!0)},style:{backgroundColor:"#000",margin:"0 10px"}},Object(n.__)("Templates Cloud","templates-patterns-collection")),Object(b.createElement)(We,{autoLoad:!1,modalOpen:r,setModalOpen:a}))};tiTpc.isSiteEditor||(Object(c.registerBlockType)("ti-tpc/templates-cloud",{title:Object(n.__)("Templates Cloud"),description:Object(n.__)("A cloud based templates library which enables you to create ready-made website in no time."),icon:j,category:"design",keywords:["templates cloud","patterns","template library"],supports:{html:!1},edit:function(e){var t=e.clientId,r=e.autoLoad,n=void 0===r||r,a=Object(b.useState)(!1),c=x()(a,2),o=c[0],i=c[1];return Object(b.createElement)(b.Fragment,null,Object(b.createElement)(We,{clientId:t,autoLoad:n,modalOpen:o,setModalOpen:i}))},save:function(){return null}}),Object(a.registerPlugin)("ti-tpc-templates-button",{render:function(){var e=Object(b.useRef)(null),t=Object(b.useRef)(null),r=Object(s.useSelect)((function(e){var t;return{isEditedPostSaveable:e("core/editor").isEditedPostSaveable(),isViewable:null===(t=e("core").getPostType(e("core/editor").getEditedPostAttribute("type")))||void 0===t?void 0:t.viewable}}),[]),n=r.isEditedPostSaveable,a=r.isViewable;return Object(b.useLayoutEffect)((function(){return t.current=document.querySelector(".edit-post-header__center"),t.current&&(e.current||(e.current=document.createElement("div"),e.current.className="ti-tpc-templates-button-wrapper"),t.current.appendChild(e.current)),function(){t.current&&e.current&&(t.current.removeChild(e.current),t.current=null)}}),[n,a]),e.current?Object(b.createPortal)(Object(b.createElement)(Ke,null),e.current):null}})),3===parseInt(tiTpc.tier)&&Object(a.registerPlugin)("ti-tpc",{render:tiTpc.isSiteEditor?function(){var e,t=Object(s.useSelect)((function(e){return{settingId:e("core/edit-site").getEditedPostId(),postType:e("core/edit-site").getEditedPostType()}})),r=t.settingId,a=t.postType,c=(0,wp.data.select(ue.store).getEntityRecord)("postType",a,r),o=Object(b.useState)(!1),l=x()(o,2),u=l[0],p=l[1],m=Object(b.useState)(""),d=x()(m,2),f=d[0],O=d[1],g=Object(b.useState)(!1),h=x()(g,2),y=h[0],_=h[1],w=Object(b.useState)({}),S=x()(w,2),P=S[0],T=S[1],B=Object(s.useDispatch)("core/notices"),F=B.createErrorNotice,L=B.createSuccessNotice,I=Object(b.useState)(!1),M=x()(I,2),U=M[0],A=M[1],V=Object(b.useState)(!1),z=x()(V,2),H=z[0],G=z[1],q=window.tiTpc.canPredefine,Q=function(){var e=wp.data.select("core/edit-site").getCurrentTemplateTemplateParts,t=wp.blocks.serialize(wp.data.select("core/editor").getBlocks());return e().forEach((function(e){var r=wp.blocks.serialize(e.block),n=e.templatePart.content.raw;t=t.replace(r,n)})),Ye(Ye({},c),{},{content:Ye(Ye({},c.content),{},{raw:t})})},$=function(){var e=k()(E.a.mark((function e(){var t,r,n,a,c,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(!0),r=Q(),n={__file:"wp_export",version:2,content:(null==r||null===(t=r.content)||void 0===t?void 0:t.raw)||""},a=J(),e.prev=4,e.next=7,C()({url:a,method:"POST",data:n,parse:!1});case 7:if((c=e.sent).ok){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,c.json();case 12:if(o=e.sent,!W(o)){e.next=15;break}return e.abrupt("return");case 15:Z(o),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(4),K(e.t0);case 21:p(!1),_(!1);case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var e,t,r=tiTpc.params,a=(r.meta,v()(r,["meta"]));return console.warn({filteredParams:a}),console.warn({templateData:P}),null!=P&&P._ti_tpc_template_id?Object(D.stringifyUrl)({url:window.tiTpc.endpoint+"templates/"+(null==P?void 0:P._ti_tpc_template_id),query:Ye(Ye({},a),{},{meta:JSON.stringify(P),template_name:f||(null==c||null===(e=c.title)||void 0===e?void 0:e.raw)||Object(n.__)("FSE Template","templates-patterns-collection")})}):Object(D.stringifyUrl)({url:window.tiTpc.endpoint+"templates",query:Ye(Ye({},a),{},{meta:JSON.stringify(P),template_name:f||(null==c||null===(t=c.title)||void 0===t?void 0:t.raw)||Object(n.__)("FSE Template","templates-patterns-collection"),template_type:"fse",template_site_slug:(null==P?void 0:P._ti_tpc_site_slug)||"",template_thumbnail:(null==P?void 0:P._ti_tpc_screenshot_url)||""})})},W=function(e){switch(e.code){case"rest_invalid_param":return F(Object(n.__)("Could not save template, check that the template is not empty.","templates-patterns-collection"),{type:"snackbar"}),!0;case"rest_forbidden":return F(Object(n.__)("You are not allowed to save templates.","templates-patterns-collection"),{type:"snackbar"}),!0;case"rest_template_invalid_id":return F(Object(n.__)("Could not save template, invalid template ID.","templates-patterns-collection")),!0;default:return!1}},Z=function(e){window.localStorage.setItem("tpcCacheBuster",R()),L(Object(n.__)("Template saved.","templates-patterns-collection"),{type:"snackbar"});var t=Ye({},P);e.template_id&&(t=Ye({_ti_tpc_template_id:e.template_id},P)),T(t),Y(r,t)},Y=function(e,t){var r=new me.a.models.Settings;r.fetch().then((function(n){var a=Ye(Ye({},n.templates_patterns_collection_fse_templates),{},i()({},e,t));r.save({templates_patterns_collection_fse_templates:a})}))},K=function(e){var t=e.message||Object(n.__)("Could not save template, check that the template is not empty.","templates-patterns-collection");F(t,{type:"snackbar"})},X=Object(s.useSelect)((function(e){var t=e(ue.store),r=t.__experimentalGetDirtyEntityRecords,n=t.isSavingEntityRecord;return r().some((function(e){return n(e.kind,e.name,e.key)}))}));return Object(b.useEffect)((function(){r&&(new me.a.models.Settings).fetch().then((function(e){var t=(null==e?void 0:e.templates_patterns_collection_fse_templates[r])||{};T(t)}))}),[r]),Object(b.useEffect)((function(){U&&!X&&P._ti_tpc_template_sync&&$(),A(X)}),[X,P,U]),Object(b.createElement)(b.Fragment,null,Object(b.createElement)(le.PluginSidebarMoreMenuItem,{icon:Object(b.createElement)(N.Icon,{icon:j}),target:"ti-tpc"},Object(n.__)("Templates Cloud")),Object(b.createElement)(le.PluginSidebar,{name:"ti-tpc",title:Object(n.__)("Templates Cloud"),className:"ti-tpc-components-panel"},Object(b.createElement)(N.PanelBody,null,Object(n.__)("Save this page as a template in your Templates Cloud library.","templates-patterns-collection"),Object(b.createElement)(N.Button,{isPrimary:!0,isBusy:y,disabled:y,onClick:k()(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==P||!P._ti_tpc_template_id){e.next=5;break}return e.next=3,$();case 3:e.next=6;break;case 5:p(!0);case 6:case"end":return e.stop()}}),e)})))},Object(n.__)("Save Page to Templates Cloud","templates-patterns-collection")),Object(b.createElement)(N.ToggleControl,{label:Object(n.__)("Automatically sync to the cloud","templates-patterns-collection"),checked:P._ti_tpc_template_sync||!1,onChange:function(){return T(Ye(Ye({},P),{},{_ti_tpc_template_sync:!P._ti_tpc_template_sync||!1}))}})),Object(b.createElement)(N.PanelBody,null,Object(n.__)("Import a template from your Templates Cloud library.","templates-patterns-collection"),Object(b.createElement)(N.Button,{isPrimary:!0,onClick:function(){return G(!0)}},Object(n.__)("Import from Templates Cloud","templates-patterns-collection"))),q&&Object(b.createElement)(fe,{templateData:P,setTemplateData:T,canPredefine:q,setLoading:_,createErrorNotice:F,createSuccessNotice:L,isLoading:y,saveMeta:function(e){Y(r,e)}})),u&&Object(b.createElement)(N.Modal,{title:Object(n.__)("Save Template","templates-patterns-collection"),onRequestClose:function(){return p(!1)}},Object(b.createElement)(N.TextControl,{label:Object(n.__)("Template Name","templates-patterns-collection"),value:f||(null==c||null===(e=c.title)||void 0===e?void 0:e.raw)||"",onChange:O}),Object(b.createElement)(N.Button,{isPrimary:!0,isBusy:y,disabled:y,onClick:$},Object(n.__)("Save","templates-patterns-collection"))),Object(b.createElement)(We,{isFse:!0,autoLoad:!1,modalOpen:H,setModalOpen:G}))}:function(){var e=Object(b.useState)(!1),t=x()(e,2),r=t[0],a=t[1],o=Object(b.useState)(!1),i=x()(o,2),l=i[0],u=i[1],p=Object(b.useState)(""),m=x()(p,2),d=m[0],O=m[1],g=window.tiTpc.canPredefine,h=Object(s.useDispatch)("core/notices"),y=h.createErrorNotice,_=h.createSuccessNotice,w=Object(s.useDispatch)("core/editor").editPost,S=Object(s.useSelect)((function(e){var t=e("core/block-editor"),r=t.getSelectedBlockCount,n=t.getSelectedBlock,a=t.getMultiSelectedBlocks,o=1===r()?n():a();return Object(c.serialize)(o)}),[]),P=Object(s.useSelect)((function(e){var t=(0,e("core/block-editor").getBlocks)();return Object(c.serialize)(t)}),[]),T=Object(s.useSelect)((function(e){return(0,e("core/editor").getEditedPostAttribute)("meta")}),[]),F=Object(s.useSelect)((function(e){return(0,e("core/editor").getEditedPostAttribute)("template")}),[]);Object(b.useEffect)((function(){var e=window.tiTpc.metaKeys;window.tiTpc.params.meta=Object.fromEntries(Object.entries(T||{}).filter((function(t){var r=x()(t,1)[0];return e.includes(r)}))),F?window.tiTpc.params.meta._wp_page_template=F:""===F&&window.tiTpc.params.meta._wp_page_template&&delete window.tiTpc.params.meta._wp_page_template}),[T,F]);var L=Object(s.useSelect)((function(e){return{meta:e("core/editor").getEditedPostAttribute("meta")||{},postId:e("core/editor").getEditedPostAttribute("id"),type:e("core/editor").getEditedPostAttribute("type"),link:e("core/editor").getEditedPostAttribute("link"),postTitle:e("core/editor").getEditedPostAttribute("title")||Object(n.__)("Template","templates-patterns-collection")}})),I=L.meta,M=L.postTitle,U=L.postId,A=L.type,V=L.link,z=L.meta,H=z._ti_tpc_template_sync,G=z._ti_tpc_template_id,q=z._ti_tpc_screenshot_url,Q=z._ti_tpc_site_slug,$=z._ti_tpc_published,J=Object(s.useSelect)((function(e,t){var r=t.forceIsSaving,n=e("core/editor"),a=n.isSavingPost,c=n.isPublishingPost,o=n.isAutosavingPost,i=r||a(),s=o();return(c()||i)&&!s})),W=Object(b.useState)(H),Z=x()(W,2),Y=Z[0],K=Z[1],ee=Object(b.useState)(G),te=x()(ee,2),re=te[0],ne=te[1],ae=Object(b.useState)(Q),ie=x()(ae,2),le=ie[0],ue=ie[1],pe=Object(b.useState)($),me=x()(pe,2),be=me[0],de=me[1],fe=Object(b.useState)(q),Oe=x()(fe,2),ge=Oe[0],he=Oe[1];Object(b.useEffect)((function(){w({meta:se(se({},I),{},{_ti_tpc_template_sync:Y,_ti_tpc_template_id:re,_ti_tpc_screenshot_url:ge,_ti_tpc_site_slug:le,_ti_tpc_published:be})})}),[Y,re,ge,le,be]),Object(b.useEffect)((function(){J&&Y&&_e()}),[J,Y]);var je=function(){var e=k()(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u("publishing"),e.prev=1,e.next=4,X(G).then((function(e){G===e.template_id&&(he(e.template_thumbnail),ve(re,!1),_(Object(n.__)("Template Data Refreshed.","templates-patterns-collection"),{type:"snackbar"}))}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),y(Object(n.__)("Something happened when refreshing the template data.","templates-patterns-collection"));case 9:u(!1);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}(),ye=function(){var e=k()(E.a.mark((function e(){var t,r,c,o,i,s,l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),t={__file:"wp_export",version:2,content:S},(r=window.tiTpc.params).meta,c=v()(r,["meta"]),o=Object(D.stringifyUrl)({url:window.tiTpc.endpoint+"templates",query:se(se({},c),{},{template_name:d,template_type:"gutenberg"})}),e.prev=4,e.next=7,C()({url:o,method:"POST",data:t,parse:!1});case 7:if(!(i=e.sent).ok){e.next=13;break}return e.next=11,i.json();case 11:(s=e.sent).message?("Sorry, you are not allowed to do that."===(l=s.message)&&(l=Object(n.__)("Could not save template, check that the template is not empty.","templates-patterns-collection")),y(l,{type:"snackbar"})):(window.localStorage.setItem("tpcCacheBuster",R()),_(Object(n.__)("Template saved.","templates-patterns-collection"),{type:"snackbar"}));case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),e.t0.message&&y(e.t0.message,{type:"snackbar"});case 18:u(!1),a(!1),O("");case 21:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(){return e.apply(this,arguments)}}(),_e=function(){var e=k()(E.a.mark((function e(){var t,r,a,c,o,i,s,l,p;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u(!0),t={__file:"wp_export",version:2,content:P},a=!1,!re){e.next=7;break}return e.next=6,X(re);case 6:a=e.sent;case 7:if(!1===a||"gutenberg"===a.template_type){e.next=9;break}return e.abrupt("return");case 9:return c=window.tiTpc.params,o=c.meta,i=v()(c,["meta"]),"neve_custom_layouts"===A&&(o=se(se({},tiTpc.params.meta),{},{postType:A})),r=a?Object(D.stringifyUrl)({url:window.tiTpc.endpoint+"templates/"+re,query:se(se({},i),{},{meta:JSON.stringify(o),template_name:M,link:V})}):Object(D.stringifyUrl)({url:window.tiTpc.endpoint+"templates",query:se(se({},i),{},{meta:JSON.stringify(o),template_name:M,template_type:"gutenberg",template_site_slug:Q||"",template_thumbnail:q||"",link:V})}),e.prev=12,e.next=15,C()({url:r,method:"POST",data:t,parse:!1});case 15:if(!(s=e.sent).ok){e.next=21;break}return e.next=19,s.json();case 19:(l=e.sent).message?("Sorry, you are not allowed to do that."===(p=l.message)&&(p=Object(n.__)("Could not save template, check that the template is not empty.","templates-patterns-collection")),y(p,{type:"snackbar"})):(window.localStorage.setItem("tpcCacheBuster",R()),_(Object(n.__)("Template saved.","templates-patterns-collection"),{type:"snackbar"}),l.template_id?(ne(l.template_id),ve(l.template_id)):ve());case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(12),e.t0.message&&y(e.t0.message,{type:"snackbar"});case 26:u(!1);case 27:case"end":return e.stop()}}),e,null,[[12,23]])})));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=null;if("post"===A?r=new wp.api.models.Post({id:U}):"page"===A?r=new wp.api.models.Page({id:U}):"neve_custom_layouts"===A&&(r=new wp.api.models.Neve_custom_layouts({id:U})),r)return r.set("meta",{_ti_tpc_template_id:e,_ti_tpc_template_sync:Y,_ti_tpc_screenshot_url:ge,_ti_tpc_site_slug:le,_ti_tpc_published:t?!be:be}),r.save()};return window.tiTpc.allowed_post.includes(A)?Object(b.createElement)(b.Fragment,null,Object(b.createElement)(B.PluginBlockSettingsMenuItem,{label:Object(n.__)("Save to Templates Cloud","templates-patterns-collection"),icon:"none",onClick:function(){return a(!0)}}),Object(b.createElement)(B.PluginSidebarMoreMenuItem,{icon:Object(b.createElement)(N.Icon,{icon:j}),target:"ti-tpc"},Object(n.__)("Templates Cloud")),Object(b.createElement)(B.PluginSidebar,{name:"ti-tpc",title:Object(n.__)("Templates Cloud"),className:"ti-tpc-components-panel"},Object(b.createElement)(N.PanelBody,null,Object(n.__)("Save this page as a template in your Templates Cloud library."),Object(b.createElement)(N.Button,{isPrimary:!0,isBusy:l,disabled:l,onClick:_e},Object(n.__)("Save Page to Templates Cloud")),Object(b.createElement)(N.ToggleControl,{label:Object(n.__)("Automatically sync to the cloud"),checked:Y,onChange:function(){return K(!Y)}})),g&&Object(b.createElement)(N.PanelBody,null,Object(b.createElement)("h4",null,Object(n.__)("Publish Settings")),Object(b.createElement)(N.TextControl,{label:Object(n.__)("Screenshot URL"),value:ge,help:Object(n.__)("Use `{generate_ss}` to publish this and have a screenshot automatically generated. Otherwise use the url to point to an image location for the template preview.","templates-patterns-collection"),type:"url",onChange:he}),Object(b.createElement)(N.TextControl,{label:Object(n.__)("Site Slug"),value:le,help:Object(n.__)("Use `general` to publish this as a global template. Otherwise use the starter site slug to make it available as a single page for the starter site.","templates-patterns-collection"),type:"url",onChange:ue}),Object(b.createElement)(ce,{canPredefine:g,setLoading:u,templateData:se(se({},I),{},{link:V}),setScreenshotURL:he,setPublished:de,saveMeta:ve,creteErrorNotice:y,createSuccessNotice:_,published:be,isLoading:l}),be&&Object(b.createElement)(N.Button,{isLink:!0,icon:"image-rotate",onClick:je,disabled:!1!==l,className:f()({"is-loading":"publishing"===l}),style:{marginLeft:"12px",textDecoration:"none"}},Object(n.__)("Refresh","templates-patterns-collection")),Object(b.createElement)(oe,null))),r&&Object(b.createElement)(N.Modal,{title:Object(n.__)("Save Template"),onRequestClose:function(){return a(!1)}},Object(b.createElement)(N.TextControl,{label:Object(n.__)("Template Name"),value:d,onChange:O}),Object(b.createElement)(N.Button,{isPrimary:!0,isBusy:l,disabled:l,onClick:ye},Object(n.__)("Save")))):null},icon:j})}]);